{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val){\r\n    return typeof val === 'function'\r\n}\r\n\r\n\r\nexport function isObject(val){\r\n    return typeof val == 'object' && val !== null\r\n}","import { isObject } from \"../utils\";\r\n\r\nclass Observe{\r\n    constructor(value){\r\n        this.walk(value) //核心就是循环对象 \r\n    }\r\n\r\n    walk(data){\r\n        // 要使用 definePrototype 重新定义 \r\n        Object.keys(data).forEach(key=>{\r\n            defineReactive(data,key,data[key])\r\n        })\r\n    }\r\n}\r\n\r\n// vue2 应用了defineProperty 需要一加载的时候就进行递归操作，所以耗性能，如果层次过深，也会浪费性能\r\n// 1.性能优化的原则：\r\n// 1）不要把所有的数据都防在data中，因为所有的数据都会增加get和set\r\n// 2）不要写数据的时候层次过深，尽量扁平化数据\r\n// 3）不要频繁获取数据 比如可以使用变量缓存 \r\n// 4）如果数据不需要响应式，可以使用 Object.freeze 冻结属性\r\n\r\n// vue2 慢的主要原因在这个方法中\r\nfunction defineReactive(obj,key,value){\r\n    observe(value)  //递归进行观测数据，不管有多少层，都进行 defineProperty\r\n    Object.defineProperty(obj,key,{\r\n        get(){\r\n            return value; //闭包 此value会像上层的value进行查找 \r\n        },\r\n        set(newValue){\r\n            if(newValue === value) return\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport function observe(value){\r\n    // 如果value不是对象，则不用观测了\r\n    if(!isObject(value)){\r\n        return\r\n    }\r\n    \r\n    // 需要对对象进行观测，最外层必须是一个 { } 不能是数组 \r\n\r\n    // 如果一个数据已经被观测过了，就不要在进行观测了，用类来实现，我观测过就增加一个标识， 说明观测过了，在观测的时候可以先检测是否观测过，如果观测过了就跳过检测 \r\n\r\n    return new Observe(value)\r\n\r\n}","import { observe } from \"./observe\"; //rollup-plugin-node-resolve\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\n// 数据的初始化\r\nfunction initData(vm) {\r\n  // 用户传入的数据\r\n  let data = vm.$options.data;\r\n\r\n  // 如果用户传递的是一个函数，则取函数的返回值作为对象，如果就是对象那就直接使用这个对象\r\n  data = isFunction(data) ? data.call(vm) : data;\r\n\r\n  // 需要将 data 变成响应式的 Object.defineProperty 重写data中的所有属性\r\n  observe(data); //观测数据\r\n  \r\n  console.log(data);\r\n}\r\n","import {initState} from './state'\r\n\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        const vm = this\r\n\r\n        // 把用户的选项放到vm上，这样在其他方法中就可以获取到options了\r\n        vm.$options = options //为了后续扩展的方法都可以获取到 options 选项\r\n\r\n        // options中是用户传入的数据 el data\r\n        initState(vm)\r\n\r\n        if(vm.$options.el){\r\n        // 要将数据挂载到页面上 \r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\n","import {initMixin} from './init'\r\n\r\n// vue要如何实现，原型模式，所有的功能都通过 原型拓展的方式来添加\r\nfunction Vue(options){\r\n    // console.log(options) \r\n    // 实现vue的初始化功能\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\n\r\n// 导出Vue\r\nexport default Vue\r\n\r\n\r\n// 1.new Vue 会调用_init 方法进行初始化操作\r\n// 2.会将用户的选项放在 vm.$options 上\r\n// 3.会对当前属性上搜索有没有data数据， initState\r\n// 4.有 data 判断data是不是一个函数，如果是函数取返回值initData\r\n// 5.observe 取观测data中的数据\r\n\r\n// 如果有el需要挂载到页面上\r\n\r\n"],"names":["isFunction","val","isObject","Observe","constructor","value","walk","data","Object","keys","forEach","key","defineReactive","obj","observe","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","call","console","log","initMixin","Vue","prototype","_init","options","el"],"mappings":";;;;;;IAAO,SAASA,UAAT,CAAoBC,GAApB,EAAwB;IAC3B,SAAO,OAAOA,GAAP,KAAe,UAAtB;IACH;IAGM,SAASC,QAAT,CAAkBD,GAAlB,EAAsB;IACzB,SAAO,OAAOA,GAAP,IAAc,QAAd,IAA0BA,GAAG,KAAK,IAAzC;IACH;;ICLD,MAAME,OAAN,CAAa;IACTC,EAAAA,WAAW,CAACC,KAAD,EAAO;IACd,SAAKC,IAAL,CAAUD,KAAV,EADc;IAEjB;;IAEDC,EAAAA,IAAI,CAACC,IAAD,EAAM;IACN;IACAC,IAAAA,MAAM,CAACC,IAAP,CAAYF,IAAZ,EAAkBG,OAAlB,CAA0BC,GAAG,IAAE;IAC3BC,MAAAA,cAAc,CAACL,IAAD,EAAMI,GAAN,EAAUJ,IAAI,CAACI,GAAD,CAAd,CAAd;IACH,KAFD;IAGH;;IAVQ;IAcb;IACA;IACA;IACA;IACA;IAEA;;;IACA,SAASC,cAAT,CAAwBC,GAAxB,EAA4BF,GAA5B,EAAgCN,KAAhC,EAAsC;IAClCS,EAAAA,OAAO,CAACT,KAAD,CAAP,CADkC;;IAElCG,EAAAA,MAAM,CAACO,cAAP,CAAsBF,GAAtB,EAA0BF,GAA1B,EAA8B;IAC1BK,IAAAA,GAAG,GAAE;IACD,aAAOX,KAAP,CADC;IAEJ,KAHyB;;IAI1BY,IAAAA,GAAG,CAACC,QAAD,EAAU;IACT,UAAGA,QAAQ,KAAKb,KAAhB,EAAuB;IACvBA,MAAAA,KAAK,GAAGa,QAAR;IACH;;IAPyB,GAA9B;IASH;;IAGM,SAASJ,OAAT,CAAiBT,KAAjB,EAAuB;IAC1B;IACA,MAAG,CAACH,QAAQ,CAACG,KAAD,CAAZ,EAAoB;IAChB;IACH,GAJyB;IAQ1B;;;IAEA,SAAO,IAAIF,OAAJ,CAAYE,KAAZ,CAAP;IAEH;;IC9CM,SAASc,SAAT,CAAmBC,EAAnB,EAAuB;IAC5B,QAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;IAEA,MAAID,IAAI,CAACd,IAAT,EAAe;IACbgB,IAAAA,QAAQ,CAACH,EAAD,CAAR;IACD;IACF;;IAGD,SAASG,QAAT,CAAkBH,EAAlB,EAAsB;IACpB;IACA,MAAIb,IAAI,GAAGa,EAAE,CAACE,QAAH,CAAYf,IAAvB,CAFoB;;IAKpBA,EAAAA,IAAI,GAAGP,UAAU,CAACO,IAAD,CAAV,GAAmBA,IAAI,CAACiB,IAAL,CAAUJ,EAAV,CAAnB,GAAmCb,IAA1C,CALoB;;IAQpBO,EAAAA,OAAO,CAACP,IAAD,CAAP,CARoB;;IAUpBkB,EAAAA,OAAO,CAACC,GAAR,CAAYnB,IAAZ;IACD;;ICrBM,SAASoB,SAAT,CAAmBC,GAAnB,EAAuB;IAC1BA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAASC,OAAT,EAAiB;IACnC,UAAMX,EAAE,GAAG,IAAX,CADmC;;IAInCA,IAAAA,EAAE,CAACE,QAAH,GAAcS,OAAd,CAJmC;IAMnC;;IACAZ,IAAAA,SAAS,CAACC,EAAD,CAAT;;IAEA,QAAGA,EAAE,CAACE,QAAH,CAAYU,EAAf,EAAkB;IAOrB,GAhBD;IAiBH;;ICjBD,SAASJ,GAAT,CAAaG,OAAb,EAAqB;IACjB;IACA;IACA,OAAKD,KAAL,CAAWC,OAAX;IACH;;IAEDJ,SAAS,CAACC,GAAD,CAAT;IAQA;IACA;IACA;IACA;IAEA;;;;;;;;"}